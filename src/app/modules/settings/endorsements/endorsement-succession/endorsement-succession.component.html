<div class="w-full p-4 flex flex-col gap-4" *transloco="let t;" tabindex="0">
  <!-- Titre et Description -->
  <div class="flex flex-col mb-6">
    <h1 class="text-2xl md:text-4xl font-bold py-4">
      {{ t('modules.settings.features.endorsements_successions') }}
    </h1>
    <p class="text-sm md:text-base text-gray-600">
      {{ t('modules.settings.features.endorsements_successions_description') }}
    </p>
  </div>

  <div class="flex flex-col md:flex-row items-center gap-4 justify-end">
    <div class="flex items-center gap-2">
        <button mat-stroked-button color="primary" class="h-11" (click)="resetToDefaults()">
          {{ t('common.reset') || 'Réinitialiser' }}
        </button>
        <button mat-raised-button color="primary" class="h-12 text-white" (click)="save()">
          {{ t('form.actions.save') || 'Enregistrer' }}
        </button>
    </div>
  </div>

  <div class="overflow-auto rounded-md border">
    <table mat-table [dataSource]="natures" class="w-full min-w-[720px]">
      <!-- Colonne FROM -->
      <ng-container matColumnDef="from">
        <th mat-header-cell *matHeaderCellDef class="px-3 py-2 text-left">
          {{ t('entities.endorsment.succession.from') || 'Depuis / Vers' }}
        </th>
        <td mat-cell *matCellDef="let row" class="px-3 py-2">
          <div class="flex items-center gap-2">
            <div class="font-medium">
              {{ t(row.labelKey) }}
            </div>

            <span class="flex-1"></span>

            <button mat-button color="primary" (click)="allowAll(row.value)">
              {{ t('common.select_all') || 'Tout cocher' }}
            </button>
            <button mat-button color="warn" (click)="clearRow(row.value)">
              {{ t('common.clear') || 'Tout décocher' }}
            </button>
          </div>
        </td>
      </ng-container>

      <!-- Colonnes TO (toutes les natures cibles) -->
      <ng-container *ngFor="let col of natures" [matColumnDef]="col.value">
        <th mat-header-cell *matHeaderCellDef class="px-3 py-2 text-center whitespace-nowrap">
          {{ t(col.labelKey) }}
        </th>
        <td mat-cell *matCellDef="let row" class="px-3 py-2 text-center">
          <mat-checkbox
            [checked]="isAllowed(row.value, col.value)"
            (change)="toggle(row.value, col.value)">
          </mat-checkbox>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row        *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>
</div>
